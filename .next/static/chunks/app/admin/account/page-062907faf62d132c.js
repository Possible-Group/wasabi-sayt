(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8398],{1472:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var t=s(5155),l=s(2115),n=s(5299);function i(){let[e,a]=(0,l.useState)(""),[s,i]=(0,l.useState)(""),[d,c]=(0,l.useState)(""),[r,u]=(0,l.useState)(null),[o,h]=(0,l.useState)(null),[m,p]=(0,l.useState)(!1);async function v(){if(h(null),u(null),!e)return h("Нужен старый пароль");if(!s&&!d)return h("Нечего менять");p(!0);try{let t=await fetch("/api/auth/admin/change-credentials",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({oldPassword:e,newLogin:s||void 0,newPassword:d||void 0})}),l=await t.json().catch(()=>null);if(!t.ok){let e=(null==l?void 0:l.error)||"Ошибка";h(e),(0,n.A)(e,"error");return}u("Сохранено"),(0,n.A)("Данные аккаунта сохранены"),a(""),i(""),c("")}catch(e){h("Ошибка"),(0,n.A)("Ошибка сохранения","error")}finally{p(!1)}}return(0,t.jsxs)("div",{className:"admin-container stack-lg",children:[(0,t.jsxs)("div",{className:"stack",children:[(0,t.jsx)("h1",{className:"admin-title",children:"Аккаунт"}),(0,t.jsx)("p",{className:"admin-subtitle",children:"Смена логина и пароля администратора."})]}),(0,t.jsxs)("div",{className:"admin-card stack",children:[(0,t.jsxs)("label",{className:"admin-field",children:["Старый пароль",(0,t.jsx)("input",{className:"admin-input",placeholder:"Старый пароль",type:"password",value:e,onChange:e=>a(e.target.value)})]}),(0,t.jsxs)("label",{className:"admin-field",children:["Новый логин (опционально)",(0,t.jsx)("input",{className:"admin-input",placeholder:"Новый логин",value:s,onChange:e=>i(e.target.value)})]}),(0,t.jsxs)("label",{className:"admin-field",children:["Новый пароль (опционально)",(0,t.jsx)("input",{className:"admin-input",placeholder:"Новый пароль",type:"password",value:d,onChange:e=>c(e.target.value)})]}),o&&(0,t.jsx)("div",{className:"text-error",children:o}),r&&(0,t.jsx)("div",{className:"text-success",children:r}),(0,t.jsx)("button",{className:"admin-button",style:{width:"100%"},disabled:m,onClick:v,children:m?"...":"Сохранить"})]})]})}},2057:(e,a,s)=>{Promise.resolve().then(s.bind(s,1472))},5299:(e,a,s)=>{"use strict";s.d(a,{A:()=>l,r:()=>t});let t="admin-toast";function l(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2400;window.dispatchEvent(new CustomEvent(t,{detail:{message:e,tone:a,duration:s}}))}}},e=>{var a=a=>e(e.s=a);e.O(0,[8441,6587,7358],()=>a(2057)),_N_E=e.O()}]);