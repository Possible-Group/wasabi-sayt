(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6631],{5299:(e,a,s)=>{"use strict";s.d(a,{A:()=>i,r:()=>t});let t="admin-toast";function i(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2400;window.dispatchEvent(new CustomEvent(t,{detail:{message:e,tone:a,duration:s}}))}},7084:(e,a,s)=>{Promise.resolve().then(s.bind(s,7957))},7957:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>d});var t=s(5155),i=s(2115),l=s(5299);function n(e){return"string"==typeof e?e.trim():""}function d(){let[e,a]=(0,i.useState)(""),[s,d]=(0,i.useState)([]),[c,r]=(0,i.useState)({}),[o,m]=(0,i.useState)(null);(0,i.useEffect)(()=>{fetch("/api/poster/categories").then(e=>e.json()).then(d),fetch("/api/admin/category-translations").then(e=>e.json()).then(e=>{let a={};e.forEach(e=>a[e.categoryId]=e),r(a)})},[]);let h=(0,i.useMemo)(()=>{let a=e.trim().toLowerCase();return a?s.filter(e=>{var s;return n(null!==(s=e.category_name)&&void 0!==s?s:"").toLowerCase().includes(a)}):s},[s,e]);function u(e,a){r(s=>({...s,[e]:{...s[e]||{categoryId:e},...a}}))}async function v(e){m(e);try{let a=c[e]||{categoryId:e},s=await fetch("/api/admin/category-translations",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({categoryId:e,nameUz:a.nameUz||"",seoTitleRu:a.seoTitleRu||"",seoDescRu:a.seoDescRu||"",seoKeywordsRu:a.seoKeywordsRu||"",seoTitleUz:a.seoTitleUz||"",seoDescUz:a.seoDescUz||"",seoKeywordsUz:a.seoKeywordsUz||""})}),t=await s.json().catch(()=>null);if(!s.ok){(0,l.A)((null==t?void 0:t.error)||"Ошибка сохранения","error");return}(null==t?void 0:t.row)&&r(a=>({...a,[e]:t.row})),(0,l.A)("Категория сохранена")}catch(e){(0,l.A)("Ошибка сохранения","error")}finally{m(null)}}return(0,t.jsxs)("div",{className:"admin-container stack-lg",children:[(0,t.jsxs)("div",{className:"stack",children:[(0,t.jsx)("h1",{className:"admin-title",children:"Категории"}),(0,t.jsx)("p",{className:"admin-subtitle",children:"Переводы категорий на узбекский и SEO для RU и UZ."})]}),(0,t.jsxs)("div",{className:"admin-inline",children:[(0,t.jsx)("input",{className:"admin-input",placeholder:"Поиск категории (RU)…",value:e,onChange:e=>a(e.target.value),style:{flex:1,minWidth:260}}),(0,t.jsxs)("div",{className:"admin-pill",children:["Всего: ",h.length]})]}),(0,t.jsx)("div",{className:"stack",children:h.map(e=>{var a,s;let i=n(null!==(a=e.category_id)&&void 0!==a?a:""),l=n(null!==(s=e.category_name)&&void 0!==s?s:""),d=e.photo||e.category_photo||"",r=c[i]||{categoryId:i};return(0,t.jsxs)("div",{className:"admin-card stack",children:[(0,t.jsx)("div",{className:"admin-inline",children:(0,t.jsxs)("div",{className:"admin-subtitle",children:["ID: ",i]})}),(0,t.jsxs)("div",{className:"admin-grid",children:[(0,t.jsxs)("div",{className:"admin-card stack",style:{boxShadow:"none"},children:[(0,t.jsx)("div",{style:{fontWeight:600},children:"RU (из Poster)"}),(0,t.jsxs)("div",{className:"admin-media",children:[(0,t.jsx)("div",{className:"admin-thumb",children:d?(0,t.jsx)("img",{src:d,alt:l,loading:"lazy"}):(0,t.jsx)("div",{className:"admin-thumb__empty",children:"Нет фото"})}),(0,t.jsxs)("div",{className:"stack",children:[(0,t.jsx)("div",{style:{fontWeight:600},children:l||"Без названия"}),(0,t.jsx)("div",{className:"admin-subtitle",children:"Категория из Poster"})]})]})]}),(0,t.jsxs)("div",{className:"admin-card stack",style:{boxShadow:"none"},children:[(0,t.jsx)("div",{style:{fontWeight:600},children:"UZ (заполняем)"}),(0,t.jsxs)("label",{className:"admin-field",children:["Название (UZ)",(0,t.jsx)("input",{className:"admin-input",placeholder:"Название (UZ)",value:r.nameUz||"",onChange:e=>u(i,{nameUz:e.target.value})})]}),(0,t.jsx)("div",{className:"admin-divider"}),(0,t.jsx)("div",{style:{fontWeight:600},children:"SEO (RU)"}),(0,t.jsxs)("label",{className:"admin-field",children:["Meta title (RU)",(0,t.jsx)("input",{className:"admin-input",placeholder:"Meta title (RU)",value:r.seoTitleRu||"",onChange:e=>u(i,{seoTitleRu:e.target.value})})]}),(0,t.jsxs)("label",{className:"admin-field",children:["Meta description (RU)",(0,t.jsx)("textarea",{className:"admin-textarea",placeholder:"Meta description (RU)",value:r.seoDescRu||"",onChange:e=>u(i,{seoDescRu:e.target.value})})]}),(0,t.jsxs)("label",{className:"admin-field",children:["Meta keywords (RU)",(0,t.jsx)("input",{className:"admin-input",placeholder:"ключ1, ключ2, ключ3",value:r.seoKeywordsRu||"",onChange:e=>u(i,{seoKeywordsRu:e.target.value})})]}),(0,t.jsx)("div",{className:"admin-divider"}),(0,t.jsx)("div",{style:{fontWeight:600},children:"SEO (UZ)"}),(0,t.jsxs)("label",{className:"admin-field",children:["Meta title (UZ)",(0,t.jsx)("input",{className:"admin-input",placeholder:"Meta title (UZ)",value:r.seoTitleUz||"",onChange:e=>u(i,{seoTitleUz:e.target.value})})]}),(0,t.jsxs)("label",{className:"admin-field",children:["Meta description (UZ)",(0,t.jsx)("textarea",{className:"admin-textarea",placeholder:"Meta description (UZ)",value:r.seoDescUz||"",onChange:e=>u(i,{seoDescUz:e.target.value})})]}),(0,t.jsxs)("label",{className:"admin-field",children:["Meta keywords (UZ)",(0,t.jsx)("input",{className:"admin-input",placeholder:"kalit1, kalit2, kalit3",value:r.seoKeywordsUz||"",onChange:e=>u(i,{seoKeywordsUz:e.target.value})})]}),(0,t.jsx)("button",{className:"admin-button",style:{width:"100%"},disabled:o===i,onClick:()=>v(i),children:o===i?"...":"Сохранить"})]})]})]},i)})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[8441,6587,7358],()=>a(7084)),_N_E=e.O()}]);