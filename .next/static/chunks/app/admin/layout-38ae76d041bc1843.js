(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7581],{94:()=>{},2236:(e,n,t)=>{"use strict";t.d(n,{default:()=>o});var a=t(5155),i=t(8173),s=t.n(i),r=t(6046),l=t(2115),d=t(5299);let c=[{href:"/admin",label:"Дашборд"},{href:"/admin/settings",label:"Настройки"},{href:"/admin/translations",label:"Переводы"},{href:"/admin/categories",label:"Категории"},{href:"/admin/content",label:"Контент"},{href:"/admin/news",label:"Новости"},{href:"/admin/reviews",label:"Отзывы"},{href:"/admin/account",label:"Аккаунт"}];function o(e){let{children:n}=e,t=(0,r.usePathname)(),i=(0,r.useRouter)(),[o,u]=(0,l.useState)(null),[m,h]=(0,l.useState)([]),f=(0,l.useRef)(new Map),v=null==t?void 0:t.startsWith("/admin/login");(0,l.useEffect)(()=>{v||fetch("/api/auth/admin/me",{cache:"no-store"}).then(e=>e.json()).then(e=>{var n;return u((null==e?void 0:null===(n=e.admin)||void 0===n?void 0:n.login)||null)}).catch(()=>u(null))},[v]),(0,l.useEffect)(()=>{function e(e){var n;let t=e.detail;if(!(null==t?void 0:t.message))return;let a="".concat(Date.now(),"-").concat(Math.random().toString(16).slice(2)),i=null!==(n=t.tone)&&void 0!==n?n:"success";h(e=>{let n=[...e,{id:a,message:t.message,tone:i}];if(n.length>4){let e=n.shift();if(e){let n=f.current.get(e.id);n&&window.clearTimeout(n),f.current.delete(e.id)}}return n});let s="number"==typeof t.duration?t.duration:2400,r=window.setTimeout(()=>{h(e=>e.filter(e=>e.id!==a)),f.current.delete(a)},s);f.current.set(a,r)}return window.addEventListener(d.r,e),()=>{window.removeEventListener(d.r,e),f.current.forEach(e=>window.clearTimeout(e)),f.current.clear()}},[]);let w=(0,l.useMemo)(()=>c.map(e=>{let n=t===e.href;return(0,a.jsx)(s(),{href:e.href,className:"admin-link".concat(n?" active":""),children:e.label},e.href)}),[t]);async function b(){await fetch("/api/auth/admin/logout",{method:"POST"}),i.replace("/admin/login")}return v?(0,a.jsx)("div",{className:"admin-login",children:n}):(0,a.jsxs)("div",{className:"admin-root",children:[(0,a.jsxs)("aside",{className:"admin-sidebar",children:[(0,a.jsx)("div",{className:"admin-brand",children:"Wasabi Admin"}),(0,a.jsx)("nav",{className:"admin-nav",children:w}),(0,a.jsxs)("div",{className:"admin-meta",children:[(0,a.jsx)("div",{children:o?"Вход: ".concat(o):"Сессия активна"}),(0,a.jsx)("button",{className:"admin-button admin-button-muted",onClick:b,children:"Выйти"})]})]}),(0,a.jsx)("main",{className:"admin-main",children:n}),m.length>0?(0,a.jsx)("div",{className:"admin-toast-stack",role:"status","aria-live":"polite",children:m.map(e=>{let n="error"===e.tone?"!":"info"===e.tone?"i":"OK";return(0,a.jsxs)("div",{className:"admin-toast admin-toast--".concat(e.tone),onClick:()=>(function(e){h(n=>n.filter(n=>n.id!==e));let n=f.current.get(e);n&&window.clearTimeout(n),f.current.delete(e)})(e.id),children:[(0,a.jsx)("div",{className:"admin-toast__icon admin-toast__icon--".concat(e.tone),children:n}),(0,a.jsx)("div",{className:"admin-toast__text",children:e.message})]},e.id)})}):null]})}},5299:(e,n,t)=>{"use strict";t.d(n,{A:()=>i,r:()=>a});let a="admin-toast";function i(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2400;window.dispatchEvent(new CustomEvent(a,{detail:{message:e,tone:n,duration:t}}))}},6046:(e,n,t)=>{"use strict";var a=t(6658);t.o(a,"useParams")&&t.d(n,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(n,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(n,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(n,{useSearchParams:function(){return a.useSearchParams}})},8153:(e,n,t)=>{Promise.resolve().then(t.bind(t,2236)),Promise.resolve().then(t.t.bind(t,94,23))}},e=>{var n=n=>e(e.s=n);e.O(0,[5639,8441,6587,7358],()=>n(8153)),_N_E=e.O()}]);