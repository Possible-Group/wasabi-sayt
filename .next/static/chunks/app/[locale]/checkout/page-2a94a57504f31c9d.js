(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7022],{290:(e,t,a)=>{"use strict";a.d(t,{IH:()=>r,Xl:()=>n,bE:()=>s,sX:()=>o,vU:()=>c});let i="wasabi_cart_v1";function n(){try{return JSON.parse(localStorage.getItem(i)||"[]")}catch(e){return[]}}function l(e){localStorage.setItem(i,JSON.stringify(e))}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=n(),i=a.findIndex(t=>t.product_id===e.product_id);return i>=0?a[i].qty+=t:a.push({...e,qty:t}),l(a),a}function r(e,t){let a=n().map(a=>a.product_id===e?{...a,qty:t}:a).filter(e=>e.qty>0);return l(a),a}function o(){l([])}function c(e){return e.reduce((e,t)=>e+t.price*t.qty,0)}},1123:(e,t,a)=>{Promise.resolve().then(a.bind(a,5072))},1272:(e,t,a)=>{"use strict";a.d(t,{t:()=>n});let i={ru:{common:{brand:"Wasabi Sushi",slogan:"Свежо, быстро, честно",openMenu:"Открыть меню",orderInTelegram:"Заказать в Telegram",menu:"Меню",cart:"Корзина",checkout:"Оформление заказа",closedNow:"Сейчас не рабочее время",workHours:"Часы работы",addToCart:"В корзину",add:"В корзину",qty:"Кол-во",delivery:"Доставка",pickup:"На вынос",persons:"Персон",phone:"Телефон",name:"Имя",address:"Адрес",comment:"Комментарий",promo:"Промокод",apply:"Применить",total:"Итого",placeOrder:"Оформить заказ",admin:"Админ",login:"Логин",password:"Пароль",signIn:"Войти",logout:"Выйти",closed:"Сейчас не рабочее время"}},uz:{common:{brand:"WASABI SUSHI",slogan:"Yangi, tez, halol",openMenu:"Menyuni ochish",orderInTelegram:"Telegramda buyurtma",menu:"Menyu",cart:"Savat",checkout:"Buyurtma berish",closedNow:"Hozir ish vaqti emas",workHours:"Ish vaqti",addToCart:"Savatga",add:"Savatga",qty:"Soni",delivery:"Yetkazib berish",pickup:"Olib ketish",persons:"Odam",phone:"Telefon",name:"Ism",address:"Manzil",comment:"Izoh",promo:"Promokod",apply:"Qo‘llash",total:"Jami",placeOrder:"Buyurtma berish",admin:"Admin",login:"Login",password:"Parol",signIn:"Kirish",logout:"Chiqish",closed:"Hozir ish vaqti emas"}}};function n(e,t,a){let n=i[e];if(!t)return n;let l=t.split("."),s=n;for(let e of l){if(!s||"object"!=typeof s||!(e in s))return null!=a?a:t;s=s[e]}return"string"==typeof s?s:null!=a?a:t}},4112:(e,t,a)=>{"use strict";a.d(t,{Zd:()=>n});let i=["ru","uz"];function n(e){return i.includes(e)}},5072:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var i=a(5155),n=a(2115),l=a(4112),s=a(1272),r=a(290),o=a(6046),c=a(4348),u=a(7564),d=a(8173),m=a.n(d);let h={ru:{loginTitle:"Войдите в аккаунт",loginText:"Для оформления заказа нужно войти или зарегистрироваться.",loginCta:"Перейти в аккаунт",locationsTitle:"Мои локации",locationsEmpty:"Сохраненных адресов пока нет.",addLocation:"Добавить локацию",hideMap:"Скрыть карту",saveLocation:"Сохранить локацию",removeLocation:"Удалить",mapTitle:"Адрес доставки на карте",mapHint:"Кликните по карте, чтобы выбрать точку доставки.",mapLoading:"Загружаем карту...",mapError:"Не удалось загрузить карту. Попробуйте позже.",pickupTitle:"Филиалы для самовывоза",pickupEmpty:"Филиалы не найдены.",paymentTitle:"Оплата",paymentCash:"Наличными",paymentCard:"Картой",bonusTitle:"Бонусы",bonusAvailable:"Доступно бонусов",bonusUse:"Списать бонусы",bonusNone:"Нет доступных бонусов",promoHint:"Промокод проверим при подтверждении.",subtotalLabel:"Сумма заказа",deliveryFeeLabel:"Доставка",packageFeeLabel:"Упаковка",bonusUsedLabel:"Списано бонусами",totalLabel:"К оплате",errAuth:"Авторизуйтесь, чтобы оформить заказ.",errLocation:"Укажите точку на карте.",errSpot:"Выберите филиал.",errPromo:"Промокод недействителен.",errBonus:"Недостаточно бонусов.",errSend:"Ошибка при отправке заказа.",successTitle:"Заказ успешно отправлен",successText:"Спасибо! Мы свяжемся с вами для подтверждения.",successOrderLabel:"Номер заказа",successCta:"К меню",successClose:"Закрыть"},uz:{loginTitle:"Profilga kiring",loginText:"Buyurtma berish uchun kirish yoki ro'yxatdan o'tish kerak.",loginCta:"Profilga o'tish",locationsTitle:"Mening manzillarim",locationsEmpty:"Saqlangan manzillar yo'q.",addLocation:"Manzil qo'shish",hideMap:"Xaritani yopish",saveLocation:"Manzilni saqlash",removeLocation:"O'chirish",mapTitle:"Yetkazish manzili",mapHint:"Xaritada yetkazish nuqtasini tanlang.",mapLoading:"Xarita yuklanmoqda...",mapError:"Xaritani yuklab bo'lmadi. Keyinroq urinib ko'ring.",pickupTitle:"Olib ketish filiallari",pickupEmpty:"Filiallar topilmadi.",paymentTitle:"To'lov",paymentCash:"Naqd",paymentCard:"Karta",bonusTitle:"Bonuslar",bonusAvailable:"Mavjud bonuslar",bonusUse:"Bonusdan foydalanish",bonusNone:"Bonuslar yo'q",promoHint:"Promokodni tasdiqlashda tekshiramiz.",subtotalLabel:"Buyurtma summasi",deliveryFeeLabel:"Yetkazish",packageFeeLabel:"Qadoq",bonusUsedLabel:"Bonusdan yechildi",totalLabel:"To'lash",errAuth:"Buyurtma uchun kirish kerak.",errLocation:"Xaritadan manzilni tanlang.",errSpot:"Filialni tanlang.",errPromo:"Promokod noto'g'ri.",errBonus:"Bonus yetarli emas.",errSend:"Buyurtma yuborishda xatolik.",successTitle:"Buyurtma yuborildi",successText:"Rahmat! Buyurtmani tasdiqlash uchun siz bilan bog'lanamiz.",successOrderLabel:"Buyurtma raqami",successCta:"Menyuga",successClose:"Yopish"}},p="yandex-maps-script",v="ad4678d0-90fa-4eef-b58c-57e0babdc17f",g="checkout-map-canvas",y="wasabi_saved_locations_v1";function f(e,t){try{return new Intl.NumberFormat("uz"===t?"uz-UZ":"ru-RU").format(e)}catch(t){return String(e)}}function b(e,t){return"".concat(e.toFixed(5),", ").concat(t.toFixed(5))}async function k(e,t){try{var a;let i=await fetch("/api/geocode?lat=".concat(e,"&lng=").concat(t),{cache:"no-store"}),n=await i.json().catch(()=>null);return String(null!==(a=null==n?void 0:n.address)&&void 0!==a?a:"").trim()||""}catch(e){return""}}function x(){try{let e=localStorage.getItem(y);if(!e)return[];let t=JSON.parse(e);if(!Array.isArray(t))return[];return t.map(e=>{var t,a;return{id:String(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""),address:String(null!==(a=null==e?void 0:e.address)&&void 0!==a?a:"").trim(),lat:Number(null==e?void 0:e.lat),lng:Number(null==e?void 0:e.lng)}}).filter(e=>e.id&&Number.isFinite(e.lat)&&Number.isFinite(e.lng)).map(e=>({...e,address:e.address||"".concat(Number(e.lat).toFixed(6),", ").concat(Number(e.lng).toFixed(6))}))}catch(e){return[]}}function j(e){try{localStorage.setItem(y,JSON.stringify(e))}catch(e){}}async function N(e){try{await fetch("/api/auth/client/locations",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({locations:e})})}catch(e){}}function S(){var e;let t=(0,o.useParams)(),a=Array.isArray(null==t?void 0:t.locale)?t.locale[0]:null==t?void 0:t.locale,d="string"==typeof a?a:"",y=(0,l.Zd)(d)?d:"ru",S="uz"===y?h.uz:h.ru,w=(0,o.useRouter)(),[_,z]=(0,n.useState)([]),[T,E]=(0,n.useState)({delivery:0,pack:0}),[C,L]=(0,n.useState)([]),[P,I]=(0,n.useState)(null),[M,O]=(0,n.useState)(!1),[A,q]=(0,n.useState)(null),[R,U]=(0,n.useState)(!0),[B,F]=(0,n.useState)("delivery"),[H,D]=(0,n.useState)(""),[W,X]=(0,n.useState)(""),[J,Y]=(0,n.useState)(""),[Q,V]=(0,n.useState)(""),[Z,K]=(0,n.useState)(""),[G,$]=(0,n.useState)("card"),[ee,et]=(0,n.useState)(""),[ea,ei]=(0,n.useState)([]),[en,el]=(0,n.useState)(!1),[es,er]=(0,n.useState)(""),[eo,ec]=(0,n.useState)(null),[eu,ed]=(0,n.useState)("idle"),em=(0,n.useRef)(null),eh=(0,n.useRef)(null),ep=(0,n.useRef)(null),ev=(0,n.useRef)(0),[eg,ey]=(0,n.useState)(null),[ef,eb]=(0,n.useState)(!1),[ek,ex]=(0,n.useState)(!1),[ej,eN]=(0,n.useState)(null),[eS,ew]=(0,n.useState)(!1);async function e_(e,t,a){let i=await k(t,a);if(i)return i;let n=async i=>{var n,l;let s=await e.geocode([t,a],{results:1,...i?{kind:i}:{}});return function(e){var t,a,i,n,l,s,r,o,c,u,d,m,h,p,v,g;if(!e)return"";let y=null===(t=e.getAddressLine)||void 0===t?void 0:t.call(e);if(y)return String(y).trim();let f=null===(i=e.properties)||void 0===i?void 0:null===(a=i.get)||void 0===a?void 0:a.call(i,"text");if(f)return String(f).trim();let b=null===(l=e.properties)||void 0===l?void 0:null===(n=l.get)||void 0===n?void 0:n.call(l,"name"),k=null===(r=e.properties)||void 0===r?void 0:null===(s=r.get)||void 0===s?void 0:s.call(r,"description");if(b&&k)return"".concat(String(k).trim(),", ").concat(String(b).trim());if(b)return String(b).trim();if(k)return String(k).trim();let x=null===(u=e.properties)||void 0===u?void 0:null===(c=u.get)||void 0===c?void 0:null===(o=c.call(u,"metaDataProperty"))||void 0===o?void 0:o.GeocoderMetaData,j=null==x?void 0:x.text;if(j)return String(j).trim();let N=null==x?void 0:null===(d=x.Address)||void 0===d?void 0:d.formatted;if(N)return String(N).trim();let S=((null===(m=e.getLocalities)||void 0===m?void 0:m.call(e))||[])[0]||((null===(h=e.getAdministrativeAreas)||void 0===h?void 0:h.call(e))||[])[0]||"",w=(null===(p=e.getThoroughfare)||void 0===p?void 0:p.call(e))||"",_=(null===(v=e.getPremise)||void 0===v?void 0:v.call(e))||"";return[S,w,(null===(g=e.getPremiseNumber)||void 0===g?void 0:g.call(e))||_].filter(Boolean).join(", ").trim()}(null==s?void 0:null===(l=s.geoObjects)||void 0===l?void 0:null===(n=l.get)||void 0===n?void 0:n.call(l,0))};try{let e=await n("house");if(e)return e}catch(e){}try{let e=await n("street");if(e)return e}catch(e){}try{let e=await n();if(e)return e}catch(e){}return""}function ez(e){var t;if(I(e.id),ec({lat:e.lat,lng:e.lng}),Y(e.address),t=e.address,/^-?\d+(?:\.\d+)?\s*,\s*-?\d+(?:\.\d+)?$/.test(t.trim())){let t=++ev.current;k(e.lat,e.lng).then(a=>{t===ev.current&&a&&(Y(a),L(t=>{let i=t.map(t=>t.id===e.id?{...t,address:a}:t);return j(i),A&&N(i),i}))}).catch(()=>void 0)}O(!1)}async function eT(){if(eo){ex(!0);try{let e=J.trim();e||(e=await k(eo.lat,eo.lng)||"".concat(eo.lat.toFixed(6),", ").concat(eo.lng.toFixed(6)));let t="",a=[];L(i=>{let n=i.find(e=>1e-5>Math.abs(e.lat-eo.lat)&&1e-5>Math.abs(e.lng-eo.lng));return n?(t=n.id,a=i.map(t=>t.id===n.id&&e&&t.address!==e?{...t,address:e}:t),j(a),N(a)):(a=[{id:t="loc_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,7)),address:e,lat:eo.lat,lng:eo.lng},...i].slice(0,10),j(a),A&&N(a)),a}),t&&I(t),Y(e),O(!1)}finally{ex(!1)}}}(0,n.useEffect)(()=>z((0,r.Xl)()),[]),(0,n.useEffect)(()=>L(x()),[]),(0,n.useEffect)(()=>{j(C)},[C]),(0,n.useEffect)(()=>{fetch("/api/menu").then(e=>e.json()).then(e=>{var t,a,i,n;E({delivery:Number(null!==(i=null==e?void 0:null===(t=e.settings)||void 0===t?void 0:t.delivery_fee)&&void 0!==i?i:0),pack:Number(null!==(n=null==e?void 0:null===(a=e.settings)||void 0===a?void 0:a.package_fee)&&void 0!==n?n:0)})}).catch(()=>E({delivery:0,pack:0}))},[]),(0,n.useEffect)(()=>{let e=!0;return U(!0),fetch("/api/auth/client/me").then(e=>e.json()).then(t=>{e&&q((null==t?void 0:t.client)||null)}).catch(()=>{e&&q(null)}).finally(()=>{e&&U(!1)}),()=>{e=!1}},[]),(0,n.useEffect)(()=>{A&&(D(e=>e||A.phone||""),X(e=>e||A.name||""))},[A]),(0,n.useEffect)(()=>{if(!A)return;let e=!0,t=x();return fetch("/api/auth/client/locations").then(e=>e.json()).then(a=>{if(!e)return;let i=Array.isArray(null==a?void 0:a.locations)?a.locations:[];if(i.length){L(i),j(i);return}t.length&&(L(t),j(t),N(t))}).catch(()=>{e&&t.length&&(L(t),j(t))}),()=>{e=!1}},[A]),(0,n.useEffect)(()=>{let e=!0;return async function(){el(!0);try{let t=await fetch("/api/locations"),a=await t.json().catch(()=>null),i=Array.isArray(null==a?void 0:a.locations)?a.locations:[];if(!i.length){let e=await fetch("/api/poster/spots"),t=await e.json().catch(()=>[]);Array.isArray(t)&&(i=t.map(e=>{var t,a,i,n,l,s,r,o;return{id:String(null!==(a=null!==(t=e.spot_id)&&void 0!==t?t:e.id)&&void 0!==a?a:""),spotId:String(null!==(n=null!==(i=e.spot_id)&&void 0!==i?i:e.id)&&void 0!==n?n:""),nameRu:null!==(l=e.name)&&void 0!==l?l:"",nameUz:null!==(s=e.name)&&void 0!==s?s:"",addressRu:null!==(r=e.address)&&void 0!==r?r:"",addressUz:null!==(o=e.address)&&void 0!==o?o:"",lat:"number"==typeof e.lat?e.lat:e.lat?Number(e.lat):null,lng:"number"==typeof e.lng?e.lng:e.lng?Number(e.lng):null}}))}if(!e)return;ei(i)}catch(t){if(!e)return;ei([])}finally{if(!e)return;el(!1)}}(),()=>{e=!1}},[]),(0,n.useEffect)(()=>{if("pickup"===B&&!es&&ea.length){let e=ea[0],t=String(e.spotId||e.id||"");t&&er(t)}},[B,ea,es]),(0,n.useEffect)(()=>{M||ed("idle")},[M]),(0,n.useEffect)(()=>{if("delivery"!==B||!M||!em.current)return;let e=!1;ed("loading");let t=window.setTimeout(()=>{eh.current||e||ed("error")},7e3);return(window.ymaps?Promise.resolve(window.ymaps):new Promise((e,t)=>{let a=document.getElementById(p);if(a){a.addEventListener("load",()=>e(window.ymaps)),a.addEventListener("error",()=>t(Error("Map load failed")));return}let i=document.createElement("script");i.id=p,i.src="https://api-maps.yandex.ru/2.1/?lang=".concat("ru_RU").concat(v?"&apikey=".concat(v):""),i.async=!0,i.onload=()=>e(window.ymaps),i.onerror=()=>t(Error("Map load failed")),document.head.appendChild(i)})).then(a=>{!e&&em.current&&a.ready(()=>{let i;if(e||!em.current)return;eh.current&&(eh.current.destroy(),eh.current=null,ep.current=null);let n=eo?[eo.lat,eo.lng]:[41.311081,69.279737];try{i=new a.Map(g,{center:n,zoom:12,controls:["zoomControl"]})}catch(e){ed("error");return}if(eh.current=i,i.container.fitToViewport(),window.setTimeout(()=>i.container.fitToViewport(),200),eo){let t=new a.Placemark([eo.lat,eo.lng],{},{draggable:!0});t.events.add("dragend",t=>{let i=t.get("target").geometry.getCoordinates(),n=Number(i[0]),l=Number(i[1]);ec({lat:n,lng:l});let s=++ev.current;e_(a,n,l).then(t=>{!e&&s===ev.current&&t&&Y(t)})}),ep.current=t,i.geoObjects.add(t)}i.events.add("click",t=>{let n=t.get("coords"),l=Number(n[0]),s=Number(n[1]);if(I(null),ec({lat:l,lng:s}),i.setCenter(n),ep.current)ep.current.geometry.setCoordinates(n);else{let e=new a.Placemark(n,{},{draggable:!0});ep.current=e,i.geoObjects.add(e)}let r=++ev.current;e_(a,l,s).then(t=>{!e&&r===ev.current&&t&&Y(t)})}),window.clearTimeout(t),ed("ready")})}).catch(()=>{e||ed("error")}),()=>{e=!0,window.clearTimeout(t),eh.current&&(eh.current.destroy(),eh.current=null,ep.current=null)}},[B,y,M]),(0,n.useEffect)(()=>{if(!eh.current)return;let e=()=>{var e,t,a;null===(a=eh.current)||void 0===a||null===(t=a.container)||void 0===t||null===(e=t.fitToViewport)||void 0===e||e.call(t)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[eu]);let eE=(0,r.vU)(_)/100,eC=Math.max(0,eE+(T.pack+("delivery"===B?T.delivery:0))),eL=Number(null!==(e=null==A?void 0:A.bonus)&&void 0!==e?e:0)||0,eP=(0,n.useMemo)(()=>{let e=Number(ee.trim().replace(",","."));return Number.isFinite(e)?e:0},[ee]),eI=Math.min(Math.max(eP,0),eL,eC),eM=Math.max(0,eC-eI);async function eO(){if(ey(null),!A){ey(S.errAuth);return}if(0===_.length)return ey("uz"===y?"Savat bo'sh":"Корзина пустая");if(!H.trim())return ey("uz"===y?"Telefon kiriting":"Введите телефон");if("delivery"===B){if(!eo)return ey(S.errLocation);if(!J.trim())return ey("uz"===y?"Manzil kiriting":"Введите адрес")}else if(!es)return ey(S.errSpot);if(eP>eL)return ey(S.errBonus);eb(!0);try{let e=await fetch("/api/orders",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({customerPhone:H.trim(),customerName:W.trim()||void 0,deliveryType:B,address:"delivery"===B?J.trim():void 0,lat:"delivery"===B?null==eo?void 0:eo.lat:void 0,lng:"delivery"===B?null==eo?void 0:eo.lng:void 0,spotId:"pickup"===B?es:void 0,paymentMethod:G,bonusAmount:eI||0,promoCode:Q.trim()||void 0,comment:Z.trim()||void 0,items:_.map(e=>({product_id:e.product_id,name:e.name,price:e.price,qty:e.qty}))})}),t=await e.json().catch(()=>null);if(!e.ok){if((null==t?void 0:t.error)==="CLOSED")return ey("".concat((0,s.t)(y,"common.closed"),". ").concat((0,s.t)(y,"common.workHours"),": ").concat(t.workStart,"–").concat(t.workEnd));if((null==t?void 0:t.error)==="UNAUTHORIZED")return ey(S.errAuth);if((null==t?void 0:t.error)==="PHONE_REQUIRED")return ey("uz"===y?"Telefon kiriting":"Введите телефон");if((null==t?void 0:t.error)==="LOCATION_REQUIRED")return ey(S.errLocation);if((null==t?void 0:t.error)==="ADDRESS_REQUIRED")return ey("uz"===y?"Manzil kiriting":"Введите адрес");if((null==t?void 0:t.error)==="SPOT_REQUIRED")return ey(S.errSpot);if((null==t?void 0:t.error)==="INVALID_PROMO")return ey(S.errPromo);if((null==t?void 0:t.error)==="BONUS_EXCEEDED")return ey(S.errBonus);return ey(S.errSend)}(0,r.sX)(),z([]),V(""),K(""),et(""),"delivery"===B&&eo&&await eT(),eN((null==t?void 0:t.orderId)?String(t.orderId):null),ew(!0)}finally{eb(!1)}}return(0,i.jsxs)("div",{className:"ws-page",children:[(0,i.jsx)(c.default,{locale:y}),(0,i.jsx)("main",{className:"site-main",children:(0,i.jsxs)("div",{className:"ws-container checkout-shell",children:[(0,i.jsx)("div",{className:"site-section__head",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"site-eyebrow",children:(0,s.t)(y,"common.checkout")}),(0,i.jsx)("h1",{className:"site-title",children:(0,s.t)(y,"common.checkout")}),(0,i.jsx)("p",{className:"site-subtitle",children:"uz"===y?"Ma'lumotlarni to'ldiring va buyurtmani tasdiqlang.":"Заполните данные и подтвердите заказ."})]})}),0===_.length?(0,i.jsxs)("div",{className:"site-card",children:[(0,i.jsx)("div",{className:"site-title",style:{fontSize:18},children:"uz"===y?"Savat bo'sh":"Корзина пустая"}),(0,i.jsx)("p",{className:"site-subtitle",children:"uz"===y?"Menyudan taom tanlang va savatga qo'shing.":"Выберите блюда из меню и добавьте в корзину."}),(0,i.jsx)(m(),{className:"site-button site-button--primary",href:"/".concat(y,"/menu"),children:"uz"===y?"Menyuga o'tish":"Перейти к меню"})]}):R?(0,i.jsx)("div",{className:"site-card",children:"uz"===y?"Yuklanmoqda...":"Загрузка..."}):A?(0,i.jsxs)("div",{className:"checkout-card",children:[(0,i.jsxs)("div",{className:"checkout-toggle",children:[(0,i.jsx)("button",{className:"delivery"===B?"is-active":"",onClick:()=>F("delivery"),children:(0,s.t)(y,"common.delivery")}),(0,i.jsx)("button",{className:"pickup"===B?"is-active":"",onClick:()=>F("pickup"),children:(0,s.t)(y,"common.pickup")})]}),"delivery"===B?(0,i.jsxs)("div",{className:"checkout-block",children:[(0,i.jsxs)("div",{className:"checkout-location-head",children:[(0,i.jsx)("div",{style:{fontWeight:600},children:S.locationsTitle}),(0,i.jsx)("button",{type:"button",className:"site-button site-button--ghost checkout-map-toggle",onClick:()=>O(e=>!e),children:M?S.hideMap:S.addLocation})]}),0===C.length?(0,i.jsx)("div",{className:"site-subtitle",children:S.locationsEmpty}):(0,i.jsx)("div",{className:"checkout-location-list",children:C.map(e=>{let t=P===e.id;return(0,i.jsxs)("div",{className:"checkout-location-row",children:[(0,i.jsxs)("button",{type:"button",className:"checkout-location-card".concat(t?" is-active":""),onClick:()=>ez(e),children:[(0,i.jsx)("input",{className:"checkout-radio",type:"radio",checked:t,onChange:()=>ez(e)}),(0,i.jsxs)("div",{className:"checkout-location-meta",children:[(0,i.jsx)("div",{style:{fontWeight:700},children:e.address}),(0,i.jsx)("div",{className:"site-subtitle",children:b(e.lat,e.lng)})]})]}),(0,i.jsx)("button",{type:"button",className:"checkout-location-remove",onClick:()=>{var t;return t=e.id,void(L(e=>{let a=e.filter(e=>e.id!==t);return j(a),A&&N(a),a}),P===t&&(I(null),ec(null),Y("")))},children:S.removeLocation})]},e.id)})}),M?(0,i.jsxs)("div",{className:"checkout-map-block",children:[(0,i.jsx)("div",{style:{fontWeight:600},children:S.mapTitle}),"error"===eu?(0,i.jsx)("div",{className:"checkout-map checkout-map__fallback",children:S.mapError}):(0,i.jsxs)("div",{className:"checkout-map",children:[(0,i.jsx)("div",{className:"checkout-map__canvas",id:g,ref:em,style:{width:"100%",height:280}}),(0,i.jsxs)("div",{className:"checkout-map__hint",children:[(0,i.jsx)("span",{children:"loading"===eu?S.mapLoading:S.mapHint}),eo?(0,i.jsxs)("span",{children:[eo.lat.toFixed(5),", ",eo.lng.toFixed(5)]}):null]})]})]}):null,(0,i.jsxs)("label",{className:"checkout-field",children:[(0,s.t)(y,"common.address"),(0,i.jsx)("input",{className:"checkout-input",placeholder:"uz"===y?"Manzil":"Адрес",value:J,onChange:e=>Y(e.target.value)})]}),(0,i.jsxs)("div",{className:"checkout-location-actions",children:[(0,i.jsx)("button",{type:"button",className:"site-button site-button--ghost",disabled:!eo||ek,onClick:()=>void eT(),children:ek?"...":S.saveLocation}),eo?(0,i.jsx)("div",{className:"site-subtitle",children:b(eo.lat,eo.lng)}):null]})]}):(0,i.jsxs)("div",{className:"checkout-block",children:[(0,i.jsx)("div",{style:{fontWeight:600},children:S.pickupTitle}),en?(0,i.jsx)("div",{className:"site-subtitle",children:"uz"===y?"Yuklanmoqda...":"Загрузка..."}):0===ea.length?(0,i.jsx)("div",{className:"site-subtitle",children:S.pickupEmpty}):(0,i.jsx)("div",{className:"checkout-pickup-list",children:ea.map(e=>{let t=String(e.spotId||e.id||""),a=es===t,n="uz"===y?e.nameUz||e.nameRu||"Filial":e.nameRu||e.nameUz||"Филиал",l="uz"===y?e.addressUz||e.addressRu:e.addressRu||e.addressUz;return(0,i.jsxs)("button",{type:"button",className:"checkout-pickup-card".concat(a?" is-active":""),onClick:()=>er(t),children:[(0,i.jsx)("input",{className:"checkout-radio",type:"radio",checked:a,onChange:()=>er(t)}),(0,i.jsxs)("div",{className:"checkout-pickup-meta",children:[(0,i.jsx)("div",{style:{fontWeight:700},children:n}),l?(0,i.jsx)("div",{className:"site-subtitle",children:l}):null]})]},e.id)})})]}),(0,i.jsxs)("div",{className:"checkout-grid",children:[(0,i.jsxs)("label",{className:"checkout-field",children:[(0,s.t)(y,"common.phone"),(0,i.jsx)("input",{className:"checkout-input",placeholder:"+998",value:H,onChange:e=>D(e.target.value)})]}),(0,i.jsxs)("label",{className:"checkout-field",children:[(0,s.t)(y,"common.name"),(0,i.jsx)("input",{className:"checkout-input",placeholder:"uz"===y?"Ism":"Имя",value:W,onChange:e=>X(e.target.value)})]})]}),(0,i.jsxs)("div",{className:"checkout-payment",children:[(0,i.jsx)("div",{style:{fontWeight:600},children:S.paymentTitle}),(0,i.jsxs)("div",{className:"checkout-payment__options",children:[(0,i.jsxs)("label",{className:"checkout-payment__option".concat("cash"===G?" is-active":""),children:[(0,i.jsx)("input",{type:"radio",name:"payment",checked:"cash"===G,onChange:()=>$("cash")}),(0,i.jsx)("span",{children:S.paymentCash})]}),(0,i.jsxs)("label",{className:"checkout-payment__option".concat("card"===G?" is-active":""),children:[(0,i.jsx)("input",{type:"radio",name:"payment",checked:"card"===G,onChange:()=>$("card")}),(0,i.jsx)("span",{children:S.paymentCard})]})]})]}),(0,i.jsxs)("div",{className:"checkout-bonus",children:[(0,i.jsx)("div",{style:{fontWeight:600},children:S.bonusTitle}),(0,i.jsxs)("div",{className:"checkout-grid",children:[(0,i.jsxs)("label",{className:"checkout-field",children:[S.bonusUse,(0,i.jsx)("input",{className:"checkout-input",type:"number",min:0,step:1,placeholder:S.bonusNone,value:ee,onChange:e=>et(e.target.value),disabled:eL<=0})]}),(0,i.jsxs)("div",{className:"checkout-field",children:[(0,i.jsx)("span",{children:S.bonusAvailable}),(0,i.jsxs)("strong",{style:{fontSize:16},children:[f(eL,y)," ","uz"===y?"so'm":"сум"]})]})]})]}),(0,i.jsxs)("div",{className:"checkout-grid",children:[(0,i.jsxs)("label",{className:"checkout-field",children:[(0,s.t)(y,"common.promo"),(0,i.jsx)("input",{className:"checkout-input",placeholder:"uz"===y?"Promo kod":"Промокод",value:Q,onChange:e=>V(e.target.value)}),(0,i.jsx)("span",{className:"site-subtitle",children:S.promoHint})]}),(0,i.jsxs)("label",{className:"checkout-field",children:[(0,s.t)(y,"common.comment"),(0,i.jsx)("textarea",{className:"checkout-input",placeholder:"uz"===y?"Izoh":"Комментарий",value:Z,onChange:e=>K(e.target.value),rows:3})]})]}),(0,i.jsx)("div",{className:"site-divider"}),(0,i.jsxs)("div",{className:"checkout-summary",children:[(0,i.jsxs)("div",{className:"checkout-summary__row",children:[(0,i.jsx)("span",{children:S.subtotalLabel}),(0,i.jsxs)("span",{children:[f(eE,y)," ","uz"===y?"so'm":"сум"]})]}),(0,i.jsxs)("div",{className:"checkout-summary__row",children:[(0,i.jsx)("span",{children:S.deliveryFeeLabel}),(0,i.jsxs)("span",{children:[f("delivery"===B?T.delivery:0,y)," ","uz"===y?"so'm":"сум"]})]}),(0,i.jsxs)("div",{className:"checkout-summary__row",children:[(0,i.jsx)("span",{children:S.packageFeeLabel}),(0,i.jsxs)("span",{children:[f(T.pack,y)," ","uz"===y?"so'm":"сум"]})]}),(0,i.jsxs)("div",{className:"checkout-summary__row",children:[(0,i.jsx)("span",{children:S.bonusUsedLabel}),(0,i.jsxs)("span",{children:["-",f(eI,y)," ","uz"===y?"so'm":"сум"]})]}),(0,i.jsxs)("div",{className:"checkout-summary__row checkout-summary__total",children:[(0,i.jsx)("span",{children:S.totalLabel}),(0,i.jsxs)("span",{children:[f(eM,y)," ","uz"===y?"so'm":"сум"]})]})]}),eg&&(0,i.jsx)("div",{style:{color:"#b42318"},children:eg}),(0,i.jsx)("button",{className:"site-button site-button--primary",disabled:ef,onClick:eO,children:ef?"...":(0,s.t)(y,"common.placeOrder")})]}):(0,i.jsxs)("div",{className:"site-card",children:[(0,i.jsx)("div",{className:"site-title",style:{fontSize:18},children:S.loginTitle}),(0,i.jsx)("p",{className:"site-subtitle",children:S.loginText}),(0,i.jsx)(m(),{className:"site-button site-button--primary",href:"/".concat(y,"/account"),children:S.loginCta})]})]})}),(0,i.jsx)(u.default,{locale:y}),eS?(0,i.jsx)("div",{className:"site-popup",role:"dialog","aria-modal":"true",children:(0,i.jsxs)("div",{className:"site-popup__card",children:[(0,i.jsx)("div",{className:"site-popup__badge",children:"Wasabi"}),(0,i.jsx)("div",{className:"site-popup__title",children:S.successTitle}),(0,i.jsx)("div",{className:"site-popup__text",children:S.successText}),ej?(0,i.jsxs)("div",{className:"site-popup__order",children:[S.successOrderLabel,": ",(0,i.jsxs)("strong",{children:["#",ej]})]}):null,(0,i.jsxs)("div",{className:"site-popup__actions",children:[(0,i.jsx)("button",{className:"site-button site-button--primary",onClick:()=>{ew(!1),w.push("/".concat(y,"/menu"))},children:S.successCta}),(0,i.jsx)("button",{className:"site-button site-button--ghost",onClick:()=>ew(!1),children:S.successClose})]})]})}):null]})}},6046:(e,t,a)=>{"use strict";var i=a(6658);a.o(i,"useParams")&&a.d(t,{useParams:function(){return i.useParams}}),a.o(i,"usePathname")&&a.d(t,{usePathname:function(){return i.usePathname}}),a.o(i,"useRouter")&&a.d(t,{useRouter:function(){return i.useRouter}}),a.o(i,"useSearchParams")&&a.d(t,{useSearchParams:function(){return i.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[3499,8441,6587,7358],()=>t(1123)),_N_E=e.O()}]);