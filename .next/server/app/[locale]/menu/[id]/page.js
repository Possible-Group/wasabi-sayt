(()=>{var e={};e.id=3245,e.ids=[3245],e.modules={882:(e,t,r)=>{Promise.resolve().then(r.bind(r,456)),Promise.resolve().then(r.bind(r,18715)),Promise.resolve().then(r.bind(r,30290))},2381:(e,t,r)=>{"use strict";function i(e){return null==e?null:String(e).trim()||null}function n(e,t){if(!e||"object"!=typeof e)return e;let r=i(e.category_id??e.categoryId??e.product_category_id??e.productCategoryId??e.category?.category_id??e.category?.id??t);return r?{...e,category_id:r}:e}function o(e){let t=(function(e){let t=e?.response;if(Array.isArray(t))return t;if(Array.isArray(t?.products))return t.products;if(Array.isArray(t?.items))return t.items;let r=(e,t)=>{let r=i(e?.category_id??e?.categoryId??e?.id??e?.category?.category_id??t);return Array.isArray(e?.products)?e.products.map(e=>n(e,r)):Array.isArray(e?.items)?e.items.map(e=>n(e,r)):[]};if(Array.isArray(t?.categories)){let e=t.categories.flatMap(e=>r(e));if(e.length)return e}if(t?.categories&&"object"==typeof t.categories){let e=Object.entries(t.categories).flatMap(([e,t])=>r(t,e));if(e.length)return e}if(t?.products&&"object"==typeof t.products){let e=Object.entries(t.products).flatMap(([e,t])=>Array.isArray(t)?t.map(t=>n(t,e)):Array.isArray(t?.products)?t.products.map(t=>n(t,e)):Array.isArray(t?.items)?t.items.map(t=>n(t,e)):[n(t,e)]);if(e.length)return e}if(t&&"object"==typeof t){let e=Object.values(t).flatMap(e=>Array.isArray(e)?e:[]);if(e.length)return e}return[]})(e).filter(e=>e&&(e.product_id||e.id||e.product_name||e.name)),r=process.env.POSTER_BASE_URL,o="";if(r)try{o=new URL(r).origin}catch{o=""}let a=e=>{let t="string"==typeof e?e.trim():"";return t?t.startsWith("/")&&o?`${o}${t}`:t:null};return t.map(e=>{let t=[e.photo_origin,e.photoOrigin,e.photo_big_origin,e.photoBigOrigin,e.photo_big,e.photoBig,e.photo_large,e.photoLarge,e.photo,e.image].find(e=>"string"==typeof e&&e.trim())||null,r=e.photo??null,i=t||r||null;return{product_id:String(e.product_id??e.id??""),product_name:function(e){let t="string"==typeof e?e.trim():"";if(!t)return"";let r=t.indexOf("$");return r>=0?t.slice(0,r).trim():t}(e.product_name??e.name??""),price:function(e){for(let t of[e?.price?.[1],e?.price?.["1"],e?.price,e?.product_price,e?.price_sum,e?.price_1,e?.price1,e?.price2,e?.price3,e?.price4,e?.price5,e?.price6,e?.price7,e?.price8,e?.price9,e?.prices]){let e=function e(t){if(null==t)return null;if("number"==typeof t)return Number.isFinite(t)?t:null;if("string"==typeof t){let e=Number(t.replace(/\s+/g,"").replace(",",".").replace(/[^0-9.-]/g,""));return Number.isFinite(e)?e:null}if(Array.isArray(t)){for(let r of t){let t=e(r);if(t&&t>0)return t}return null}if("object"==typeof t){for(let r of[t.price,t.value,t.sum,t.amount]){let t=e(r);if(t&&t>0)return t}for(let r of Object.values(t)){let t=e(r);if(t&&t>0)return t}}return null}(t);if(e&&e>0)return e}return 0}(e),photo:a(i),photo_origin:a(t),photo_raw:r,ingredients:e.ingredients??null,description:e.description??null,category_name:e.category_name??e.menu_category_name??e.category?.category_name??e.category?.name??null,category_id:e.category_id?String(e.category_id):e.menu_category_id?String(e.menu_category_id):e.menuCategoryId?String(e.menuCategoryId):e.categoryId?String(e.categoryId):e.category?.category_id?String(e.category.category_id):e.category?.id?String(e.category.id):e.product_category_id?String(e.product_category_id):e.productCategoryId?String(e.productCategoryId):null}})}r.d(t,{E:()=>o})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3714:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});let i=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/components/layout/Header.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/components/layout/Header.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},10858:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});let i={ru:{common:{brand:"Wasabi Sushi",slogan:"Свежо, быстро, честно",openMenu:"Открыть меню",orderInTelegram:"Заказать в Telegram",menu:"Меню",cart:"Корзина",checkout:"Оформление заказа",closedNow:"Сейчас не рабочее время",workHours:"Часы работы",addToCart:"В корзину",add:"В корзину",qty:"Кол-во",delivery:"Доставка",pickup:"На вынос",persons:"Персон",phone:"Телефон",name:"Имя",address:"Адрес",comment:"Комментарий",promo:"Промокод",apply:"Применить",total:"Итого",placeOrder:"Оформить заказ",admin:"Админ",login:"Логин",password:"Пароль",signIn:"Войти",logout:"Выйти",closed:"Сейчас не рабочее время"}},uz:{common:{brand:"WASABI SUSHI",slogan:"Yangi, tez, halol",openMenu:"Menyuni ochish",orderInTelegram:"Telegramda buyurtma",menu:"Menyu",cart:"Savat",checkout:"Buyurtma berish",closedNow:"Hozir ish vaqti emas",workHours:"Ish vaqti",addToCart:"Savatga",add:"Savatga",qty:"Soni",delivery:"Yetkazib berish",pickup:"Olib ketish",persons:"Odam",phone:"Telefon",name:"Ism",address:"Manzil",comment:"Izoh",promo:"Promokod",apply:"Qo‘llash",total:"Jami",placeOrder:"Buyurtma berish",admin:"Admin",login:"Login",password:"Parol",signIn:"Kirish",logout:"Chiqish",closed:"Hozir ish vaqti emas"}}};function n(e,t,r){let n=i[e];if(!t)return n;let o=t.split("."),a=n;for(let e of o){if(!a||"object"!=typeof a||!(e in a))return r??t;a=a[e]}return"string"==typeof a?a:r??t}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30290:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var i=r(45512),n=r(58009),o=r(28531),a=r.n(o),s=r(61910),l=r(10858);let c={ru:{back:"Вернуться на главную",ingredients:"Состав",description:"Описание",badge:"Скидка",gift:"Подарок",added:"добавлено в корзину"},uz:{back:"Bosh sahifaga qaytish",ingredients:"Tarkibi",description:"Tavsif",badge:"Chegirma",gift:"Sovg'a",added:"savatga qo'shildi"}};function u({locale:e,product:t}){let r="uz"===e?c.uz:c.ru,[o,u]=(0,n.useState)(1),[d,p]=(0,n.useState)(null),m=(0,n.useRef)(null),[f,g]=(0,n.useState)(null),y=(0,n.useMemo)(()=>(function(e,t){if(!t)return null;if(t.is_bonus)return 0;let r=null;t.discount_value>0&&(3===t.result_type?r=Math.max(0,Math.round(e*(1-t.discount_value/100))):1===t.result_type&&(r=Math.max(0,Math.round(e-t.discount_value))));let i=function(e){if(!Array.isArray(e)||0===e.length)return null;let t=[],r=[];for(let i of e){let e=function e(t){if(null==t)return null;if("number"==typeof t)return Number.isFinite(t)?t:null;if("string"==typeof t){let e=Number(t.replace(/\s+/g,"").replace(",",".").replace(/[^0-9.-]/g,""));return Number.isFinite(e)?e:null}if(Array.isArray(t)){for(let r of t){let t=e(r);if(t&&t>0)return t}return null}if("object"==typeof t){for(let r of[t.price_value,t.price,t.value,t.sum,t.amount,t.price_1,t.price1,t["1"]]){let t=e(r);if(t&&t>0)return t}for(let r of Object.values(t)){let t=e(r);if(t&&t>0)return t}}return null}(i);e&&!(e<=0)&&("1"===("object"==typeof i&&i?String(i.price_id??i.priceId??""):"")?t.push(Math.round(e)):r.push(Math.round(e)))}let i=t.length?t:r;return i.length?Math.min(...i):null}(t.discount_prices);return null!==i&&i>0?null===r?i:Math.min(r,i):r})(t.price,f),[t.price,f]),h=f?.is_bonus||null!==y&&y<t.price,_=h&&null!==y?y:t.price,b="uz"===e?"so'm":"сум",v=e=>{p(e),m.current&&window.clearTimeout(m.current),m.current=window.setTimeout(()=>p(null),2200)},x=f?.is_bonus?r.gift:r.badge,j=f?.is_bonus?"product-detail__badge":"product-detail__badge product-detail__badge--discount";return(0,i.jsxs)("div",{className:"product-detail",children:[(0,i.jsxs)("div",{className:"product-detail__media",children:[h?(0,i.jsx)("div",{className:j,children:x}):null,(0,i.jsx)("img",{src:t.image||"/icons/logo.png",alt:t.name,loading:"lazy",decoding:"async"})]}),(0,i.jsxs)("div",{className:"product-detail__info",children:[(0,i.jsxs)(a(),{className:"product-detail__back",href:`/${e}`,children:["← ",r.back]}),t.categoryName?(0,i.jsx)("div",{className:"product-detail__category",children:t.categoryName}):null,(0,i.jsx)("h1",{className:"product-detail__title",children:t.name}),(0,i.jsx)("div",{className:"product-detail__price",children:h&&null!==y?(0,i.jsxs)("div",{className:"site-price",children:[(0,i.jsxs)("span",{className:"site-price__old",children:[(t.price/100).toLocaleString()," ",b]}),(0,i.jsxs)("span",{className:"site-price__new",children:[(y/100).toLocaleString()," ",b]})]}):(0,i.jsxs)("span",{children:[(t.price/100).toLocaleString()," ",b]})}),t.description?(0,i.jsxs)("div",{className:"product-detail__section",children:[(0,i.jsx)("div",{className:"product-detail__label",children:r.description}),(0,i.jsx)("p",{className:"product-detail__text",children:t.description})]}):null,t.ingredients?(0,i.jsxs)("div",{className:"product-detail__section",children:[(0,i.jsx)("div",{className:"product-detail__label",children:r.ingredients}),(0,i.jsx)("p",{className:"product-detail__text",children:t.ingredients})]}):null,(0,i.jsxs)("div",{className:"product-detail__actions",children:[(0,i.jsxs)("div",{className:"site-qty",children:[(0,i.jsx)("button",{className:"site-qty__btn",type:"button",onClick:()=>u(e=>Math.max(1,e-1)),"aria-label":"uz"===e?"Kamaytirish":"Уменьшить",children:"−"}),(0,i.jsx)("div",{className:"site-qty__val",children:o}),(0,i.jsx)("button",{className:"site-qty__btn",type:"button",onClick:()=>u(e=>e+1),"aria-label":"uz"===e?"Oshirish":"Увеличить",children:"+"})]}),(0,i.jsx)("button",{className:"site-button site-button--primary",type:"button",onClick:()=>{(0,s.bE)({product_id:t.id,name:t.name,price:_,image:t.image||void 0},o),v(`${t.name} \xd7 ${o} ${r.added}`)},children:(0,l.t)(e,"common.add")})]})]}),d&&(0,i.jsx)("div",{className:"site-toast",role:"status","aria-live":"polite",children:(0,i.jsx)("div",{className:"site-toast__body",children:d})})]})}},33873:e=>{"use strict";e.exports=require("path")},35233:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b,generateMetadata:()=>_});var i=r(62740),n=r(31831),o=r(80636),a=r(23952),s=r(39676),l=r(2381),c=r(3714),u=r(51084),d=r(62806);function p(e){return e?(function e(t){if(null==t)return"";if("string"==typeof t)return t;if("number"==typeof t)return String(t);if(Array.isArray(t))return t.map(t=>e(t)).filter(Boolean).join(", ");if("object"==typeof t){let r=function(e){if(!e||"object"!=typeof e)return"";for(let t of[e.name,e.product_name,e.ingredient_name,e.item_name,e.title,e.caption])if("string"==typeof t&&t.trim())return t.trim();return""}(t);if(r){let e=function(e){if(!e||"object"!=typeof e)return null;let t=e.count??e.qty??e.quantity??e.amount;if(null==t)return null;let r=Number(String(t).replace(",","."));return Number.isFinite(r)&&r>1?r:null}(t);return e?`${r} \xd7 ${e}`:r}let i=e(t.product??t.ingredient??t.item??t.items??t.products??t.ingredients??t.value);return i||Object.entries(t).filter(e=>{let[,t]=e;return"string"==typeof t&&t.trim().length>0}).filter(([e])=>!["id","product_id","ingredient_id"].includes(e)).map(([,e])=>e.trim()).join(" ")}return""})(e).replace(/\s+/g," ").trim():""}async function m(){let e=await (0,s.i)("menu.getProducts"),t=(0,l.E)(e);if(0===t.length){let e=await (0,s.i)("menu.getCategories"),r=(Array.isArray(e?.response)&&e.response||Array.isArray(e?.categories)&&e.categories||[]).map(e=>String(e?.category_id??e?.id??"").trim()).filter(Boolean);t=(await Promise.all(r.map(e=>(0,s.i)("menu.getProducts",{category_id:e}).catch(()=>null)))).flatMap((e,t)=>{if(!e)return[];let i=(0,l.E)(e);if(!i.length)return[];let n=r[t];return i.map(e=>e.category_id?e:{...e,category_id:n})})}return t}async function f(e){let t=e.trim();if(!t)return null;try{let e=await (0,s.i)("menu.getProducts",{product_id:t}),r=(0,l.E)(e).find(e=>String(e.product_id??e.id??"")===t);if(r)return r}catch{}return(await m()).find(e=>String(e.product_id??e.id??"")===t)||null}async function g(e,t){if(!e||"uz"!==t)return null;let r=await a.z.categoryTranslation.findUnique({where:{categoryId:e},select:{nameUz:!0}});return r?.nameUz||null}async function y(e){return a.z.productTranslation.findUnique({where:{productId:e}})}async function h(e,t){let r=await f(t);if(!r)return null;let i=String(r.product_id||t),n=await y(i),o="uz"===e?await g(String(r.category_id??""),e)||r.category_name||null:r.category_name||null,a="uz"===e&&n?.nameUz?n.nameUz:r.product_name||"",s="uz"===e&&n?.descUz?n.descUz:r.description||"";return{product:{id:i,name:a||"",price:Number(r.price??0),image:r.photo_origin||r.photo||r.photo_raw||null,description:p(s)||null,ingredients:p(r.ingredients)||null,categoryName:p(o)||null},translation:n}}async function _({params:e}){let t=await e,r=(0,o.Zd)(t.locale)?t.locale:"ru",i=await h(r,t.id);if(!i)return{title:"Wasabi"};let{product:n,translation:a}=i,s="uz"===r?a?.seoTitleUz||"":a?.seoTitleRu||"",l="uz"===r?a?.seoDescUz||"":a?.seoDescRu||"",c="uz"===r?a?.seoKeywordsUz||"":a?.seoKeywordsRu||"",u=s||n.name||"Wasabi",d=function(e,t=160){return e.length<=t?e:e.slice(0,Math.max(0,t-1)).trimEnd()+"…"}(l||n.description||n.ingredients||"");return{title:u,description:d,keywords:c||void 0,openGraph:{title:u,description:d,images:n.image?[n.image]:void 0}}}async function b({params:e}){let t=await e,r=(0,o.Zd)(t.locale)?t.locale:"ru",a=await h(r,t.id);return a?(0,i.jsxs)("div",{className:"ws-page",children:[(0,i.jsx)(c.default,{locale:r}),(0,i.jsx)("main",{className:"site-main",children:(0,i.jsx)("section",{className:"site-section",children:(0,i.jsx)("div",{className:"ws-container",children:(0,i.jsx)(d.default,{locale:r,product:a.product})})})}),(0,i.jsx)(u.default,{locale:r})]}):(0,n.notFound)()}},37301:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return l}});let i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=e[a]}return i.default=e,r&&r.set(e,i),i}(r(76301));function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}let o={current:null},a="function"==typeof i.cache?i.cache:e=>e,s=console.warn;function l(e){return function(...t){s(e(...t))}}a(e=>{try{s(o.current)}finally{o.current=null}})},37834:(e,t,r)=>{Promise.resolve().then(r.bind(r,51084)),Promise.resolve().then(r.bind(r,3714)),Promise.resolve().then(r.bind(r,62806))},39676:(e,t,r)=>{"use strict";r.d(t,{i:()=>a});let i=process.env.POSTER_TOKEN||process.env.POSTER_ACCESS_TOKEN,n=process.env.POSTER_BASE_URL;function o(e,t){if(!t)throw Error(`Missing env ${e}`);return t}async function a(e,t={},r={}){let s=o("POSTER_TOKEN",i),l=o("POSTER_BASE_URL",n).replace(/\/$/,""),c=r.httpMethod??"GET",u=new URL(`${l}/${e}`);u.searchParams.set("token",s),u.searchParams.set("format","json");let d={cache:"no-store",method:c};if("GET"===c)for(let[e,r]of Object.entries(t))void 0!==r&&u.searchParams.set(e,String(r));else{let e=new URLSearchParams;for(let[r,i]of Object.entries(t))void 0!==i&&e.set(r,String(i));d.headers={"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},d.body=e.toString()}let p=await fetch(u.toString(),d),m=await p.text().catch(()=>"");if(!p.ok)throw Error(`Poster error ${p.status}: ${m||p.statusText}`);let f=m?JSON.parse(m):{};if(f?.error){let e="object"==typeof f.error?JSON.stringify(f.error):String(f.error),t=f?.message?` ${f.message}`:"";throw Error(`Poster API error: ${e}${t}`)}return f}},51084:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});let i=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/components/layout/Footer.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/components/layout/Footer.tsx","default")},59998:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>d,pages:()=>u,routeModule:()=>p,tree:()=>c});var i=r(70260),n=r(28203),o=r(25155),a=r.n(o),s=r(67292),l={};for(let e in s)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>s[e]);r.d(t,l);let c={children:["",{children:["[locale]",{children:["menu",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,35233)),"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/[locale]/menu/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,95694)),"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/[locale]/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,19611)),"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"]}]}.children,u=["/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/[locale]/menu/[id]/page.tsx"],d={require:r,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/[locale]/menu/[id]/page",pathname:"/[locale]/menu/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},61910:(e,t,r)=>{"use strict";function i(){return[]}function n(e){localStorage.setItem("wasabi_cart_v1",JSON.stringify(e))}function o(e,t=1){let r=[],i=r.findIndex(t=>t.product_id===e.product_id);return i>=0?r[i].qty+=t:r.push({...e,qty:t}),n(r),r}function a(e,t){let r=[].map(r=>r.product_id===e?{...r,qty:t}:r).filter(e=>e.qty>0);return n(r),r}function s(){n([])}function l(e){return e.reduce((e,t)=>e+t.price*t.qty,0)}r.d(t,{IH:()=>a,Xl:()=>i,bE:()=>o,sX:()=>s,vU:()=>l})},62806:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});let i=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/components/product/ProductDetail.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/components/product/ProductDetail.tsx","default")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[638,475,9620,7321],()=>r(59998));module.exports=i})();