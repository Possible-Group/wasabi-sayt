(()=>{var e={};e.id=4609,e.ids=[4609],e.modules={3218:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>d,pages:()=>u,routeModule:()=>h,tree:()=>c});var r=a(70260),s=a(28203),n=a(25155),i=a.n(n),l=a(67292),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let c={children:["",{children:["[locale]",{children:["account",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,50265)),"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/[locale]/account/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,95694)),"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/[locale]/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,19611)),"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,41485,23)),"next/dist/client/components/unauthorized-error"]}]}.children,u=["/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/[locale]/account/page.tsx"],d={require:a,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/[locale]/account/page",pathname:"/[locale]/account",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20840:(e,t,a)=>{"use strict";a.d(t,{Zd:()=>s});let r=["ru","uz"];function s(e){return r.includes(e)}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},37301:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return o}});let r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=n?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(r,i,l):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(76301));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(s=function(e){return e?a:t})(e)}let n={current:null},i="function"==typeof r.cache?r.cache:e=>e,l=console.warn;function o(e){return function(...t){l(e(...t))}}i(e=>{try{l(n.current)}finally{n.current=null}})},44016:(e,t,a)=>{Promise.resolve().then(a.bind(a,56141))},50265:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/[locale]/account/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/[locale]/account/page.tsx","default")},56141:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(45512),s=a(58009),n=a(79334),i=a(18715),l=a(456),o=a(20840);let c={ru:{eyebrow:"Аккаунт",title:"Личный кабинет",subtitle:"Войдите или зарегистрируйтесь, чтобы копить бонусы.",loginTitle:"Вход",loginText:"Введите номер телефона и пароль для входа.",registerTitle:"Регистрация",registerText:"Создайте профиль и начните копить бонусы.",nameLabel:"Имя",phoneLabel:"Телефон",passwordLabel:"Пароль",birthdayLabel:"Дата рождения",loginBtn:"Войти",registerBtn:"Зарегистрироваться",profileTitle:"Профиль",bonusLabel:"Бонусы",logout:"Выйти",phonePlaceholder:"+998 90 123 45 67",namePlaceholder:"Ваше имя",passwordPlaceholder:"Введите пароль",birthdayPlaceholder:"1995-05-20",clientNotFound:"Клиент не найден. Зарегистрируйтесь.",invalidCredentials:"Неверный номер или пароль.",clientAlreadyRegistered:"Номер уже зарегистрирован. Войдите.",invalidPhone:"Некорректный номер телефона.",passwordTooShort:"Пароль должен быть минимум 8 символов.",birthdayRequired:"Введите дату рождения для подтверждения.",birthdayMismatch:"Дата рождения не совпадает с данными в Poster."},uz:{eyebrow:"Profil",title:"Shaxsiy kabinet",subtitle:"Kirish yoki ro'yxatdan o'ting va bonuslar yig'ing.",loginTitle:"Kirish",loginText:"Kirish uchun telefon raqamingiz va parolingizni kiriting.",registerTitle:"Ro'yxatdan o'tish",registerText:"Profil yarating va bonuslar yig'ishni boshlang.",nameLabel:"Ism",phoneLabel:"Telefon",passwordLabel:"Parol",birthdayLabel:"Tug'ilgan sana",loginBtn:"Kirish",registerBtn:"Ro'yxatdan o'tish",profileTitle:"Profil",bonusLabel:"Bonuslar",logout:"Chiqish",phonePlaceholder:"+998 90 123 45 67",namePlaceholder:"Ismingiz",passwordPlaceholder:"Parolni kiriting",birthdayPlaceholder:"1995-05-20",clientNotFound:"Mijoz topilmadi. Ro'yxatdan o'ting.",invalidCredentials:"Telefon yoki parol noto'g'ri.",clientAlreadyRegistered:"Bu raqam allaqachon ro'yxatdan o'tgan. Kirishingiz mumkin.",invalidPhone:"Telefon raqami noto'g'ri.",passwordTooShort:"Parol kamida 8 ta belgidan iborat bo'lishi kerak.",birthdayRequired:"Tasdiqlash uchun tug'ilgan sanani kiriting.",birthdayMismatch:"Tug'ilgan sana Poster ma'lumotlariga mos kelmadi."}};function u(){let e=(0,n.useParams)(),t=Array.isArray(e?.locale)?e.locale[0]:e?.locale,a="string"==typeof t?t:"",u=(0,o.Zd)(a)?a:"ru",d="uz"===u?c.uz:c.ru,[h,p]=(0,s.useState)(null),[m,b]=(0,s.useState)(!0),[g,x]=(0,s.useState)(!1),[y,f]=(0,s.useState)(null),[v,j]=(0,s.useState)("login"),[P,N]=(0,s.useState)(""),[w,T]=(0,s.useState)(""),[_,S]=(0,s.useState)(""),[k,O]=(0,s.useState)(""),[C,I]=(0,s.useState)(""),[L,R]=(0,s.useState)(""),D=(0,s.useMemo)(()=>(function(e,t){try{return new Intl.NumberFormat("uz"===t?"uz-UZ":"ru-RU").format(e)}catch{return String(e)}})(h?.bonus||0,u),[h?.bonus,u]);async function A(){if(P.trim()&&w.trim()){x(!0),f(null);try{let e=await fetch("/api/auth/client/login",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({phone:P.trim(),password:w.trim()})}),t=await e.json().catch(()=>null);if(!e.ok){t?.error==="CLIENT_NOT_FOUND"?(f(d.clientNotFound),j("register"),O(P.trim())):t?.error==="INVALID_CREDENTIALS"?f(d.invalidCredentials):t?.error==="INVALID_PHONE"?f(d.invalidPhone):t?.error==="PASSWORD_TOO_SHORT"?f(d.passwordTooShort):f("Ошибка");return}p(t?.client||null)}catch{f("Ошибка")}finally{x(!1)}}}async function q(){if(_.trim()&&k.trim()&&C.trim()){x(!0),f(null);try{let e=await fetch("/api/auth/client/register",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:_.trim(),phone:k.trim(),birthday:L||"",password:C.trim()})}),t=await e.json().catch(()=>null);if(!e.ok){t?.error==="CLIENT_ALREADY_REGISTERED"?f(d.clientAlreadyRegistered):t?.error==="INVALID_PHONE"?f(d.invalidPhone):t?.error==="PASSWORD_TOO_SHORT"?f(d.passwordTooShort):t?.error==="BIRTHDAY_REQUIRED"?f(d.birthdayRequired):t?.error==="BIRTHDAY_MISMATCH"?f(d.birthdayMismatch):f("Ошибка");return}p(t?.client||null),N(k.trim()),T(""),I("")}catch{f("Ошибка")}finally{x(!1)}}}async function E(){x(!0),f(null);try{await fetch("/api/auth/client/logout",{method:"POST"}),p(null)}finally{x(!1)}}return(0,r.jsxs)("div",{className:"ws-page",children:[(0,r.jsx)(i.default,{locale:u}),(0,r.jsx)("main",{className:"site-main",children:(0,r.jsx)("section",{className:"site-section",children:(0,r.jsxs)("div",{className:"ws-container",children:[(0,r.jsx)("div",{className:"site-section__head",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"site-eyebrow",children:d.eyebrow}),(0,r.jsx)("h1",{className:"site-title",children:d.title}),(0,r.jsx)("p",{className:"site-subtitle",children:d.subtitle})]})}),m?(0,r.jsx)("div",{className:"site-card account-card",children:"uz"===u?"Yuklanmoqda...":"Загрузка..."}):h?(0,r.jsx)("div",{className:"account-grid",children:(0,r.jsxs)("div",{className:"site-card account-card account-profile",children:[(0,r.jsxs)("div",{className:"account-pill",children:["ID: ",h.id]}),(0,r.jsx)("div",{className:"account-name",children:h.name||("uz"===u?"Mehmon":"Гость")}),(0,r.jsx)("div",{className:"account-phone",children:h.phone}),(0,r.jsxs)("div",{className:"account-bonus",children:[(0,r.jsx)("span",{children:d.bonusLabel}),(0,r.jsx)("strong",{children:D})]}),y&&(0,r.jsx)("div",{className:"account-message is-error",children:y}),(0,r.jsx)("div",{className:"account-actions",children:(0,r.jsx)("button",{className:"site-button site-button--primary",disabled:g,onClick:E,children:d.logout})})]})}):(0,r.jsx)("div",{className:"account-grid",children:(0,r.jsxs)("div",{className:"site-card account-card",children:[(0,r.jsxs)("div",{className:"account-tabs",role:"tablist",children:[(0,r.jsx)("button",{type:"button",className:`account-tab${"login"===v?" is-active":""}`,onClick:()=>j("login"),children:d.loginTitle}),(0,r.jsx)("button",{type:"button",className:`account-tab${"register"===v?" is-active":""}`,onClick:()=>j("register"),children:d.registerTitle})]}),"login"===v?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"account-card__title",children:d.loginTitle}),(0,r.jsx)("div",{className:"account-card__text",children:d.loginText}),(0,r.jsxs)("label",{className:"account-field",children:[d.phoneLabel,(0,r.jsx)("input",{className:"account-input",type:"tel",inputMode:"tel",value:P,onChange:e=>N(e.target.value),placeholder:d.phonePlaceholder})]}),(0,r.jsxs)("label",{className:"account-field",children:[d.passwordLabel,(0,r.jsx)("input",{className:"account-input",type:"password",value:w,onChange:e=>T(e.target.value),placeholder:d.passwordPlaceholder})]}),y&&(0,r.jsx)("div",{className:"account-message is-error",children:y}),(0,r.jsx)("button",{className:"site-button site-button--primary",disabled:g,onClick:A,children:d.loginBtn})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"account-card__title",children:d.registerTitle}),(0,r.jsx)("div",{className:"account-card__text",children:d.registerText}),(0,r.jsxs)("label",{className:"account-field",children:[d.nameLabel,(0,r.jsx)("input",{className:"account-input",value:_,onChange:e=>S(e.target.value),placeholder:d.namePlaceholder})]}),(0,r.jsxs)("label",{className:"account-field",children:[d.phoneLabel,(0,r.jsx)("input",{className:"account-input",type:"tel",inputMode:"tel",value:k,onChange:e=>O(e.target.value),placeholder:d.phonePlaceholder})]}),(0,r.jsxs)("label",{className:"account-field",children:[d.passwordLabel,(0,r.jsx)("input",{className:"account-input",type:"password",value:C,onChange:e=>I(e.target.value),placeholder:d.passwordPlaceholder})]}),(0,r.jsxs)("label",{className:"account-field",children:[d.birthdayLabel,(0,r.jsx)("input",{className:"account-input",type:"date",value:L,onChange:e=>R(e.target.value),placeholder:d.birthdayPlaceholder})]}),y&&(0,r.jsx)("div",{className:"account-message is-error",children:y}),(0,r.jsx)("button",{className:"site-button site-button--ghost",disabled:g,onClick:q,children:d.registerBtn})]})]})})]})})}),(0,r.jsx)(l.default,{locale:u})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},85872:(e,t,a)=>{Promise.resolve().then(a.bind(a,50265))},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638,475,9620,7321],()=>a(3218));module.exports=r})();