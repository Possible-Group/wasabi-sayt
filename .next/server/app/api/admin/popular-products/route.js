(()=>{var e={};e.id=4034,e.ids=[4034],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7659:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>w,routeModule:()=>x,serverHooks:()=>g,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{GET:()=>d,POST:()=>m});var n=t(42706),a=t(28203),i=t(45994),u=t(39187),o=t(65658),p=t(23952),c=t(67695);let l=o.Ik({ids:o.YO(o.Yj())});async function d(){if(!await (0,c.ZT)())return u.NextResponse.json({error:"Unauthorized"},{status:401});let e=await p.z.botSetting.findUnique({where:{key:"popular_products"}});return u.NextResponse.json({ids:function(e){if(!e)return[];try{let r=JSON.parse(e);if(Array.isArray(r))return r.map(e=>String(e).trim()).filter(Boolean)}catch{}return[]}(e?.value)})}async function m(e){if(!await (0,c.ZT)())return u.NextResponse.json({error:"Unauthorized"},{status:401});let r=Array.from(new Set(l.parse(await e.json()).ids.map(e=>String(e).trim()).filter(Boolean))),t=JSON.stringify(r);return await p.z.botSetting.upsert({where:{key:"popular_products"},create:{key:"popular_products",value:t},update:{value:t}}),u.NextResponse.json({ok:!0,ids:r})}let x=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/admin/popular-products/route",pathname:"/api/admin/popular-products",filename:"route",bundlePath:"app/api/admin/popular-products/route"},resolvedPagePath:"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/api/admin/popular-products/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:f,workUnitAsyncStorage:y,serverHooks:g}=x;function w(){return(0,i.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:y})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},23952:(e,r,t)=>{"use strict";t.d(r,{z:()=>n});var s=t(96330);let n=global.prisma||new s.PrismaClient({log:["error"]})},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67695:(e,r,t)=>{"use strict";t.d(r,{Au:()=>p,Or:()=>c,ZT:()=>d,ln:()=>l});var s=t(43008),n=t.n(s),a=t(44512);let i=process.env.ADMIN_COOKIE_NAME||"wasabi_admin_session";async function u(e){(await (0,a.UL)()).set(i,e,{httpOnly:!0,sameSite:"lax",secure:!0,path:"/"})}async function o(){(await (0,a.UL)()).set(i,"",{httpOnly:!0,sameSite:"lax",secure:!0,path:"/",maxAge:0})}async function p(e){let r=function(e){let r=process.env.ADMIN_JWT_SECRET;return n().sign(e,r,{expiresIn:"7d"})}({sub:e.adminId,login:e.login});await u(r)}async function c(){let e=await (0,a.UL)(),r=e.get(i)?.value;if(!r)return null;let t=function(e){try{let r=process.env.ADMIN_JWT_SECRET;return n().verify(e,r)}catch{return null}}(r);return t?{adminId:t.sub,login:t.login}:null}async function l(){await o()}async function d(){return c()}},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,5452,4512,3008,5658],()=>t(7659));module.exports=s})();