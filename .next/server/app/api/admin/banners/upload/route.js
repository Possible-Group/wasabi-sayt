(()=>{var e={};e.id=4965,e.ids=[4965],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9875:(e,r,t)=>{"use strict";t.d(r,{FH:()=>p,rY:()=>o,wK:()=>c});var s=t(79748),n=t(33873),a=t.n(n);let i=(()=>{let e=process.env.UPLOADS_DIR,r=e?a().resolve(e):a().join(process.cwd(),"public","uploads");return r.endsWith(a().sep)?r:`${r}${a().sep}`})();function u(...e){let r=a().normalize(a().join(i,...e));if(!r.startsWith(i))throw Error("Invalid upload path");return r}async function o(e,r,t){let n=u(e);await (0,s.mkdir)(n,{recursive:!0});let i=a().join(n,r);return await (0,s.writeFile)(i,t),i}function p(e,r){let t=e.replace(/^\/+|\/+$/g,"");return`/uploads/${t}/${r}`}function c(e){if(!Array.isArray(e)||0===e.length)throw Error("Missing path");return u(...e)}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},59586:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>g,routeModule:()=>x,serverHooks:()=>y,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>v});var s={};t.r(s),t.d(s,{POST:()=>m,runtime:()=>f});var n=t(42706),a=t(28203),i=t(45994),u=t(39187),o=t(55511),p=t(33873),c=t.n(p),l=t(67695),d=t(9875);let f="nodejs";async function m(e){if(!await (0,l.ZT)())return u.NextResponse.json({error:"Unauthorized"},{status:401});let r=(await e.formData()).get("file");if(!(r instanceof File))return u.NextResponse.json({error:"Missing file"},{status:400});let t=await r.arrayBuffer(),s=Buffer.from(t),n=c().extname(r.name||"").slice(1),a=n?`.${n}`:".jpg",i=`${Date.now()}-${(0,o.randomUUID)()}${a}`;return await (0,d.rY)("banners",i,s),u.NextResponse.json({url:(0,d.FH)("banners",i)})}let x=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/admin/banners/upload/route",pathname:"/api/admin/banners/upload",filename:"route",bundlePath:"app/api/admin/banners/upload/route"},resolvedPagePath:"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/api/admin/banners/upload/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:w,workUnitAsyncStorage:v,serverHooks:y}=x;function g(){return(0,i.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:v})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67695:(e,r,t)=>{"use strict";t.d(r,{Au:()=>p,Or:()=>c,ZT:()=>d,ln:()=>l});var s=t(43008),n=t.n(s),a=t(44512);let i=process.env.ADMIN_COOKIE_NAME||"wasabi_admin_session";async function u(e){(await (0,a.UL)()).set(i,e,{httpOnly:!0,sameSite:"lax",secure:!0,path:"/"})}async function o(){(await (0,a.UL)()).set(i,"",{httpOnly:!0,sameSite:"lax",secure:!0,path:"/",maxAge:0})}async function p(e){let r=function(e){let r=process.env.ADMIN_JWT_SECRET;return n().sign(e,r,{expiresIn:"7d"})}({sub:e.adminId,login:e.login});await u(r)}async function c(){let e=await (0,a.UL)(),r=e.get(i)?.value;if(!r)return null;let t=function(e){try{let r=process.env.ADMIN_JWT_SECRET;return n().verify(e,r)}catch{return null}}(r);return t?{adminId:t.sub,login:t.login}:null}async function l(){await o()}async function d(){return c()}},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79748:e=>{"use strict";e.exports=require("fs/promises")},96487:()=>{}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,5452,4512,3008],()=>t(59586));module.exports=s})();