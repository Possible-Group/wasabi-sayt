(()=>{var e={};e.id=4107,e.ids=[4107],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},23952:(e,r,t)=>{"use strict";t.d(r,{z:()=>n});var a=t(96330);let n=global.prisma||new a.PrismaClient({log:["error"]})},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67695:(e,r,t)=>{"use strict";t.d(r,{Au:()=>l,Or:()=>c,ZT:()=>d,ln:()=>p});var a=t(43008),n=t.n(a),s=t(44512);let i=process.env.ADMIN_COOKIE_NAME||"wasabi_admin_session";async function o(e){(await (0,s.UL)()).set(i,e,{httpOnly:!0,sameSite:"lax",secure:!0,path:"/"})}async function u(){(await (0,s.UL)()).set(i,"",{httpOnly:!0,sameSite:"lax",secure:!0,path:"/",maxAge:0})}async function l(e){let r=function(e){let r=process.env.ADMIN_JWT_SECRET;return n().sign(e,r,{expiresIn:"7d"})}({sub:e.adminId,login:e.login});await o(r)}async function c(){let e=await (0,s.UL)(),r=e.get(i)?.value;if(!r)return null;let t=function(e){try{let r=process.env.ADMIN_JWT_SECRET;return n().verify(e,r)}catch{return null}}(r);return t?{adminId:t.sub,login:t.login}:null}async function p(){await u()}async function d(){return c()}},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},96330:e=>{"use strict";e.exports=require("@prisma/client")},96395:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>y,routeModule:()=>f,serverHooks:()=>v,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>g});var a={};t.r(a),t.d(a,{DELETE:()=>x,GET:()=>d,POST:()=>m});var n=t(42706),s=t(28203),i=t(45994),o=t(39187),u=t(65658),l=t(23952),c=t(67695);let p=u.Ik({id:u.ai().int().optional(),imageUrl:u.Yj().min(1),href:u.Yj().optional(),locale:u.k5(["ru","uz","all"]).optional(),sortOrder:u.ai().int().optional(),active:u.zM().optional()});async function d(){if(!await (0,c.ZT)())return o.NextResponse.json({error:"Unauthorized"},{status:401});let e=await l.z.banner.findMany({orderBy:[{sortOrder:"asc"},{id:"asc"}]});return o.NextResponse.json(e)}async function m(e){if(!await (0,c.ZT)())return o.NextResponse.json({error:"Unauthorized"},{status:401});let r=p.parse(await e.json()),t=r.id?await l.z.banner.update({where:{id:r.id},data:{imageUrl:r.imageUrl,href:r.href??null,locale:r.locale??"all",sortOrder:r.sortOrder??0,active:r.active??!0}}):await l.z.banner.create({data:{imageUrl:r.imageUrl,href:r.href??null,locale:r.locale??"all",sortOrder:r.sortOrder??0,active:r.active??!0}});return o.NextResponse.json({ok:!0,row:t})}async function x(e){if(!await (0,c.ZT)())return o.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:r}=new URL(e.url),t=Number(r.get("id")||0);return t?(await l.z.banner.delete({where:{id:t}}),o.NextResponse.json({ok:!0})):o.NextResponse.json({error:"Missing id"},{status:400})}let f=new n.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/admin/banners/route",pathname:"/api/admin/banners",filename:"route",bundlePath:"app/api/admin/banners/route"},resolvedPagePath:"/Users/mycomp/Documents/IT/Projects/wasabi/wasabi-sayt-2/app/api/admin/banners/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:w,workUnitAsyncStorage:g,serverHooks:v}=f;function y(){return(0,i.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:g})}},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,5452,4512,3008,5658],()=>t(96395));module.exports=a})();